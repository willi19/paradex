cnos_utils
==========

.. py:module:: cnos_utils

.. autoapi-nested-parse::

   Code From https://github.com/nv-nguyen/cnos







Module Contents
---------------

.. py:class:: BatchedData(batch_size, data=None, **kwargs)

   A structure for storing data in batched format.
   Implements basic filtering and concatenation.


   .. py:attribute:: batch_size


   .. py:method:: cat(data, dim=0)


   .. py:method:: append(data)


   .. py:method:: stack(dim=0)


.. py:class:: CustomResizeLongestSide(target_length: int, dividable_size: int)

   Bases: :py:obj:`segment_anything.utils.transforms.ResizeLongestSide`


   .. py:attribute:: dividable_size


   .. py:method:: get_preprocess_shape(oldh: int, oldw: int, long_side_length: int, dividable_size: int) -> Tuple[int, int]
      :staticmethod:


      Compute the output size given input size and target long side length.



   .. py:method:: apply_image(image: numpy.ndarray) -> numpy.ndarray

      Expects a numpy array with shape HxWxC in uint8 format.



   .. py:method:: apply_image_torch(image: torch.Tensor) -> torch.Tensor

      Expects batched images with shape BxCxHxW and float format. This
      transformation may not exactly match apply_image. apply_image is
      the transformation expected by the model.



   .. py:method:: apply_coords_torch(coords: torch.Tensor, original_size: Tuple[int, Ellipsis]) -> torch.Tensor

      Expects a torch tensor with length 2 in the last dimension. Requires the
      original image size in (H, W) format.



   .. py:method:: apply_boxes_torch(boxes: torch.Tensor, original_size: Tuple[int, Ellipsis]) -> torch.Tensor

      Expects a torch tensor with shape Bx4. Requires the original image
      size in (H, W) format.



.. py:class:: CropResizePad(target_size, pad_value=0.0)

   .. py:attribute:: target_size


   .. py:attribute:: target_ratio


   .. py:attribute:: target_max


   .. py:attribute:: pad_value
      :value: 0.0



.. py:function:: xyxy_to_xywh(bbox)

.. py:function:: xywh_to_xyxy(bbox)

   Convert [x, y, w, h] box format to [x1, y1, x2, y2] format.


.. py:function:: get_bbox_size(bbox)

.. py:function:: make_bbox_dividable(bbox_size, dividable_size, ceil=True)

.. py:function:: make_bbox_square(old_bbox)

.. py:function:: crop_image(image, bbox, format='xyxy')

.. py:function:: force_binary_mask(mask, threshold=0.0)

